---
title: "RWire"
author: "Fabian"
---

## Introduction
RWire is an R package for the correlation analysis of single-cell ATAC-seq data. This vignette shows how to use it to calculate accessibility matrices and correlation matrices in order to identify co-regulated genomic regions.

## Installation
RWire can be installed by starting R and typing:
```
install.packages("devtools")
devtools::install_github("FabianErdel/RWire")
```

## Loading required libraries
```
library("ggplot2")
library("data.table")
library("GenomicRanges")
```

## Making a list of genomic regions of interest (here for chromosome 18)
```
tiles <- makeTiles(18)
```

## Loading path to sample data
```
path <- system.file("extdata", package = "RWire")
```

## Making an accessibility matrix
```
# Make accessibility matrix from a set of bed files
am <- makeAccMatrix(path, tiles)

# delete empty rows
am <- am[rowSums(am[,4:dim(am)[2]])>0, ]
```

## Making a histogram for integrations per cell and integrations per region
```
hist_ipc <- makeIPCHist(am)
print(hist_ipc)

hist_ipr <- makeIPRHist(am)
print(hist_ipr[[1]])
```

## Retrieving some statistics
```
makeIPCStats(am)
makeIPRStats(am)
```

## Making a correlation matrix
```
cor <- makeCorMatrix(am)
```

## Making a correlation matrix that is scaled to genomic coordinates
```
size <- 200
scm <- scaleCorMatrix(cor, size)
```

## Saving the scaled correlation matrix as an image
```
saveImage(scm, "your_path", size, size, getCorLUT(), -1, 1)
```
